---
title: "Seminário"
subtitle: "2ECO118 - Economia Brasileira"
author: "João P. Cortapasso <br> Mestrando em Economia Regional <br><br><a href='https://github.com/cortapasso'><i class='fa-brands fa-github'></i>&nbsp; cortapasso</a>"
date: 06/09/2022 <br> <img src="img/ppe.png" class="imgleft"/> <img src="img/logo.png" class="imgright"/>
bibliography: "styles/ref.bib"
csl:  "styles/abnt3.csl"
format: 
  revealjs:
    theme: [default, "styles/custom.scss"]
    menu: false
    slide-number: true
editor: visual
include-in-header: "styles/header.html"
---

::: {.center .titulo}
## O milagre econômico e a distribuição de renda no Brasil {background-color="black" background-image="img/bg.webp" background-size="cover"}
:::

## Definição

::: {.incremental .paragrafo}
-   Período entre 1968 a 1973;
-   Denominado milagre econômico por conta de políticas monetárias expansionista e crescimento da atividade econômica;
-   Gradual redução da inflação e do desequilíbrio externo;
-   Elevado crescimento do produto interno da economia brasileira, numa média de até 11% anual;
-   Superávits no balanço de pagamentos.
:::


```{r}
#| echo: false
#| message: false
#| results: hide
#| warning: false
  
options(encoding = "UTF-8")
library(ipeadatar)
library(tidyverse)
library(ggplot2)
library(tsibble)
library(ggrepel)

pib_data <- ipeadatar::ipeadata("SCN10_PIBG10")
pib_data <- pib_data %>% select(-uname, -tcode, -code)
pib_data <- pib_data %>% mutate(
  milagre = if_else(date >= "1968-01-01" & date <= "1972-01-01", TRUE, FALSE)
)

pib_ts <-  tsibble(
  Ano = (pib_data$date),
  Valor = pib_data$value,
  Milagre = pib_data$milagre,
  index = Ano
)

igpdi_data <- ipeadatar::ipeadata("IGP_IGPDIG")
igpdi_data <- igpdi_data %>% select(-uname, -tcode, -code)
igpdi_data <- igpdi_data %>% mutate(
  milagre = if_else(date >= "1968-01-01" & date <= "1972-01-01", TRUE, FALSE)
)

igpdi_ts <- tsibble(
  Ano = igpdi_data$date,
  Valor = igpdi_data$value,
  Milagre = igpdi_data$milagre,
  index = Ano
)

#Decidi deixar esse jeito de lado, pois o de baixo da um resultado melhor :D
#series_plot <- series_ts %>% 
#  ggplot(aes(x = Ano, y = Valor)) +
#    labs(title = "Produto Interno bruto a preços de mercado: variação real anual",
#         subtitle = "1945-1965",
#         caption = "Fonte: Ipeadata",
#         x = "Anos",
#         y = "Variação em (%)") +
#    geom_line(colour = "#008FD5", size = 1) +
#    ylim(0, 12) +
#    scale_x_date(limits = as.Date(c("1945-01-01","1965-01-01")), date_labels = "%Y", date_breaks = "5 years") +
#    theme(aspect.ratio = 1) +
#    theme(plot.caption.position = "plot",
#        plot.caption = element_text(hjust = 0)) +
#    theme(plot.title.position = "plot") +
#    theme(axis.line = element_line(size = 0.5))

pib_plot <- pib_ts %>%
  filter(between(Ano, as.Date("1965-01-01"), as.Date("1975-01-01"))) %>% 
  ggplot(aes(x = Ano, y = Valor), group = Milagre) +
  labs(title = "Produto Interno bruto a preços de mercado: variação real anual em (%)",
       subtitle = "1965-1975",
       caption = "Fonte: Ipeadata",
       x = "Anos",
       y = "Variação em (%)") +
  geom_line(aes(col = Milagre, group = 1), size = 1.5) +
  scale_color_manual(values = c("#000000", "#FF0000")) +
  geom_point() +
  geom_text_repel(aes(label = round(Valor, digits = 2)), size = 3, nudge_y = 1.5) +
  ylim(0, 15.5) +
  scale_x_date(date_labels = "%Y", date_breaks = "1 year") +
  theme(#aspect.ratio = 0.8,
    plot.caption.position = "plot",
    plot.title.position = "plot",
    plot.caption = element_text(hjust = 0),
    axis.line = element_line(size = 0.5),
    plot.title = element_text(size = 18),
    legend.position = "none")
  #annotate("text", as.Date("1968-01-01"), y = 11, label = "Início") +
  #annotate("point", as.Date("1968-01-01"), y = 9.8, size = 5.5, shape = 1, fill = "transparent") +
  #annotate("text", as.Date("1973-01-01"), y = 15, label = "Fim") +
  #annotate("point", as.Date("1973-01-01"), y = 14, size = 5.5, shape = 1, fill = "transparent")

igpdi_plot <- igpdi_ts %>%
  filter(between(Ano, as.Date("1965-01-01"), as.Date("1975-01-01"))) %>% 
  ggplot(aes(x = Ano, y = Valor), group = Milagre) +
  labs(title = "Índice geral de preços - disponibilidade interna (IGP-DI)",
       subtitle = "1965-1975",
       caption = "Fonte: Ipeadata",
       x = "Anos",
       y = "Variação em (%)") +
  geom_line(aes(col = Milagre, group = 1), size = 1.5) +
  scale_color_manual(values = c("#000000", "#FF0000")) +
  geom_point() +
#  geom_text(aes(label = round(Valor, digits = 2)), vjust = -2, hjust = 0,
#            size = 3, angle = 45, position = position_dodge(5)) +
  geom_text_repel(aes(label = round(Valor, digits = 2)), size = 3, nudge_y = 5) +
  ylim(15, 45) +
  scale_x_date(date_labels = "%Y", date_breaks = "1 year") +
  theme(#aspect.ratio = 0.8,
    plot.caption.position = "plot",
    plot.title.position = "plot",
    plot.caption = element_text(hjust = 0),
    axis.line = element_line(size = 0.5),
    plot.title = element_text(size = 18),
    legend.position = "none")
  #annotate("text", as.Date("1968-01-01"), y = 24, label = "Início", hjust = 1) +
  #annotate("point", as.Date("1968-01-01"), y = 25.5, size = 5.5, shape = 1, fill = "transparent") +
  #annotate("text", as.Date("1973-01-01"), y = 15.5, label = "Fim", hjust = -1) +
  #annotate("point", as.Date("1973-01-01"), y = 15.5, size = 5.5, shape = 1, fill = "transparent")

```

## 

```{r}
#| echo: false
#| message: false
#| warning: false
#| fig-align: center
#| fig-format: retina
#| fig-dpi: 300
#| fig-width: 9
#| fig-height: 7

pib_plot

```

## 

```{r}
#| echo: false
#| message: false
#| warning: false
#| fig-align: center
#| fig-format: retina
#| fig-dpi: 300
#| fig-width: 9
#| fig-height: 7

igpdi_plot

```

## Precedentes do Milagre Econômico

::: {.incremental .paragrafo}
-   PAEG;
-   Denominado milagre econômico por conta de políticas monetárias expansionista e crescimento da atividade econômica;
-   Gradual redução da inflação e do desequilíbrio externo;
-   Elevado crescimento do produto interno da economia brasileira, numa média de até 11% anual;
-   Superávits no balanço de pagamentos.
:::

## Referências

::: {#refs}
:::
